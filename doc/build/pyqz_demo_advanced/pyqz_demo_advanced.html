

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Running pyqz (advanced) &mdash; pyqz 0.7.3 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="pyqz 0.7.3 documentation" href="../index.html"/>
        <link rel="next" title="Understanding pyqz" href="../understanding.html"/>
        <link rel="prev" title="Running pyqz (basic)" href="../pyqz_demo_basic/pyqz_demo_basic.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> pyqz
          

          
          </a>

          
            
            
              <div class="version">
                0.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing pyqz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyqz_demo_basic/pyqz_demo_basic.html">Running pyqz (basic)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Running pyqz (advanced)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#advanced-use-1-using-custom-mappings-grids">Advanced use 1: using custom MAPPINGS grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-usage-2-resampling-the-original-mappings-grids">Advanced usage 2: resampling the original MAPPINGS grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-usage-3-pseudo-3-d-line-ratio-diagrams">Advanced usage 3: pseudo 3-D line ratio diagrams</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../understanding.html">Understanding pyqz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyqz_demo_param/pyqz_demo_param.html">The parameters of pyqz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">The functions of pyqz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledge.html">Acknowledging pyqz</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">pyqz</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Running pyqz (advanced)</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/pyqz_demo_advanced/pyqz_demo_advanced.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running-pyqz-advanced">
<span id="runningpyqzadvanced"></span><h1>Running pyqz (advanced)<a class="headerlink" href="#running-pyqz-advanced" title="Permalink to this headline">¶</a></h1>
<p>This page is also available as an IPython notebook
(<code class="docutils literal"><span class="pre">pyqz_demo_advanced.ipynb</span></code>) included with the code and located in
<code class="docutils literal"><span class="pre">pyqz/examples/</span></code>.</p>
<p>First things first, let&#8217;s start by importing pyqz.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pyqz</span>

<span class="go">Multiprocessing possible with: 8 cpus max.</span>
<span class="go">Loaded matplotlib with backend: agg</span>
<span class="go">Loaded pyqz 0.7.2</span>
</pre></div>
</div>
<div class="section" id="advanced-use-1-using-custom-mappings-grids">
<h2>Advanced use 1: using custom MAPPINGS grids<a class="headerlink" href="#advanced-use-1-using-custom-mappings-grids" title="Permalink to this headline">¶</a></h2>
<p>While pyqz ships with a default set of HII region simulations from
MAPPINGS, some (all!) users might be interested in using pyqz with their
own specific sets of MAPPINGS simulations. pyqz was designed to be
compatible with the grids generated from the awk script provided
alongside MAPPINGS.</p>
<p>If one uses the awk script to create new MAPPINGS grids, the resulting
<code class="docutils literal"><span class="pre">.csv</span></code> file must be placed inside <code class="docutils literal"><span class="pre">pyqz/reference_data/</span></code>. The filename must
match what the function <code class="docutils literal"><span class="pre">pyqz.get_MVphotogrid_fn()</span></code> expects for your
given set of parameters, e.g. should you have run a MAPPINGS model for
<span class="math">\(\log\)</span>(P/k)=6.7, plane-parralel HII regions and
<span class="math">\(\kappa=10\)</span>, the resulting grid name for the <code class="docutils literal"><span class="pre">.csv</span></code> file must be:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pyqz</span><span class="o">.</span><span class="n">get_MVphotogrid_fn</span><span class="p">(</span><span class="n">Pk</span><span class="o">=</span><span class="mf">6.7</span><span class="p">,</span><span class="n">calibs</span><span class="o">=</span><span class="s1">&#39;GCZO&#39;</span><span class="p">,</span> <span class="n">kappa</span> <span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">struct</span><span class="o">=</span><span class="s1">&#39;pp&#39;</span><span class="p">)</span>

<span class="go">&#39;/Users/fvogt/Tools/Python/fpav_pylib/pyqz/pyqz_dev/reference_data/grid_QZ_pp_GCZO_Pk67_k10.csv&#39;</span>
</pre></div>
</div>
<p>If one does not use the awk script to generate the custom MAPPINGS grid,
then <em>just</em> make sure your model grid matches the format of existing model
grids located in <code class="docutils literal"><span class="pre">pyqz/reference_data/</span></code> ...</p>
</div>
<div class="section" id="advanced-usage-2-resampling-the-original-mappings-grids">
<h2>Advanced usage 2: resampling the original MAPPINGS grids<a class="headerlink" href="#advanced-usage-2-resampling-the-original-mappings-grids" title="Permalink to this headline">¶</a></h2>
<p>By default, 2 times resampled MAPPINGS grid are shipped with <code class="docutils literal"><span class="pre">pyqz</span></code>. These
are generated using the function <code class="docutils literal"><span class="pre">pyqz.resample_MVphotogrid()</span></code>, which is
straightforward to use:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">grid_fn</span> <span class="o">=</span> <span class="n">pyqz</span><span class="o">.</span><span class="n">get_MVphotogrid_fn</span><span class="p">(</span><span class="n">Pk</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span><span class="n">struct</span><span class="o">=</span><span class="s1">&#39;sph&#39;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pyqz</span><span class="o">.</span><span class="n">resample_MVphotogrid</span><span class="p">(</span><span class="n">grid_fn</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="go">Success: grid_QZ_sph_GCZO_Pk50_kinf.csv resampled by a factor 2x2 and</span>
<span class="go">saved as grid_QZ_sph_GCZO_Pk50_kinf_samp_2.csv</span>
</pre></div>
</div>
<p>More densely resampled grids can then easily be created by varying the
<code class="docutils literal"><span class="pre">sampling</span></code> keyword.</p>
</div>
<div class="section" id="advanced-usage-3-pseudo-3-d-line-ratio-diagrams">
<h2>Advanced usage 3: pseudo 3-D line ratio diagrams<a class="headerlink" href="#advanced-usage-3-pseudo-3-d-line-ratio-diagrams" title="Permalink to this headline">¶</a></h2>
<p>pyqz does support 2-D line ratio diagrams constructed from 3 sets of
line ratios (i.e. 3-D line ratio diagrams projected to a given 2-D
plane):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bad_segments</span> <span class="o">=</span> <span class="n">pyqz</span><span class="o">.</span><span class="n">check_grid</span><span class="p">(</span><span class="s1">&#39;[NII]/[SII]+;[NII]/Ha;[OIII]/Hb&#39;</span><span class="p">,</span>
<span class="go">                 coeffs = [[1.0,0.264,0.0],[0.242,-0.910,0.342]],</span>
<span class="go">                 show_plot=False,</span>
<span class="go">                 save_plot=&#39;./example_plots/check_grid_3D.png&#39;,</span>
<span class="go">                 struct=&#39;sph&#39;,</span>
<span class="go">                 sampling=1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;./example_plots/check_grid_3D.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/output_13_0.png" class="align-center" src="../_images/output_13_0.png" />
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../understanding.html" class="btn btn-neutral float-right" title="Understanding pyqz" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../pyqz_demo_basic/pyqz_demo_basic.html" class="btn btn-neutral" title="Running pyqz (basic)" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2016, Frédéric P.A. Vogt.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.7.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>